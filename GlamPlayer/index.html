<!DOCTYPE html>
<html>
  <head>
    <title>Youtube IFrame</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
  </head>
  <body style="margin: 0; padding: 0; background: black">
    <div id="player"></div>

    <script>   
      var tag = document.createElement('script');
      tag.src = "https://www.youtube.com/iframe_api";
      var firstScriptTag = document.getElementsByTagName('script')[0];
      firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);

      var player;
      function onYouTubeIframeAPIReady() {
        player = new YT.Player('player', {
          height: '390',
          width: '640',
          // videoId: 'M7lc1UVf-VE',
          events: {
            'onReady': onPlayerReady,
            'onStateChange': onPlayerStateChange
          }
        });
      }

      function onPlayerReady(event) {
        window.external.InitializeMapChangeListener();
      }
      
      function onPlayerStateChange(event) {
        
      }

      function setIFrameSize(width, height){
        player.setSize(width, height);
      }

      var lastPlayedId;
      var fadeInterval;
      var volumeLimit = 100;

      function start(id){

        if(lastPlayedId != id){
          lastPlayedId = id;
          player.loadVideoById(id);
        }
        else{ // If we're playing the same thing again, don't bother reloading
          player.playVideo()
        }

      }

      function fadeStart(id){

          clearInterval(fadeInterval); // stop any existing fade in or fade out

          start(id)
          player.setVolume(0);

          fadeInterval = setInterval(function(){

            var volume = player.getVolume();

            if(volume == volumeLimit){
              clearInterval(fadeInterval);
            }
            else{
              volume += 5;
              if(volume > volumeLimit){
                volume = volumeLimit;
              }
            }

            player.setVolume(volume);

          },100);
      }

      function stop() {
        player.stopVideo();
      }

      function fadeStop(){
         
          clearInterval(fadeInterval);
          fadeInterval = setInterval(function(){

            var volume = player.getVolume();

            if(volume == 0){
              clearInterval(fadeInterval);
              player.stopVideo();
            }
            else{
              volume -= 5;
            
              if(volume < 0){
                volume = 0;
              }
            }
            
            player.setVolume(volume);
            
          },50); 

      }

    </script>
  </body>
</html>